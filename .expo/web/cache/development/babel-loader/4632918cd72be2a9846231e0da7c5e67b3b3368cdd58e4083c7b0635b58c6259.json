{"ast":null,"code":"import * as SQLite from 'expo-sqlite';\nvar db = SQLite.openDatabase('soundscope.db');\nexport var initDB = function initDB() {\n  return new Promise(function (resolve, reject) {\n    db.transaction(function (tx) {\n      tx.executeSql(`CREATE TABLE IF NOT EXISTS patients (\n          id INTEGER PRIMARY KEY AUTOINCREMENT,\n          name TEXT NOT NULL,\n          photo_uri TEXT,\n          dob TEXT,\n          estimated_age INTEGER,\n          chief_complaint TEXT,\n          triage_category TEXT DEFAULT 'P3',\n          last_scan_result TEXT,\n          created_at TEXT DEFAULT CURRENT_TIMESTAMP\n        );`, [], function () {\n        return resolve();\n      }, function (_, error) {\n        return reject(error);\n      });\n    });\n  });\n};\nexport var addPatient = function addPatient(patient) {\n  return new Promise(function (resolve, reject) {\n    var name = patient.name,\n      photo_uri = patient.photo_uri,\n      dob = patient.dob,\n      estimated_age = patient.estimated_age,\n      chief_complaint = patient.chief_complaint,\n      triage_category = patient.triage_category,\n      last_scan_result = patient.last_scan_result;\n    db.transaction(function (tx) {\n      tx.executeSql(`INSERT INTO patients (name, photo_uri, dob, estimated_age, chief_complaint, triage_category, last_scan_result) VALUES (?, ?, ?, ?, ?, ?, ?);`, [name, photo_uri, dob, estimated_age, chief_complaint, triage_category || 'P3', last_scan_result || ''], function (_, result) {\n        return resolve(result);\n      }, function (_, error) {\n        return reject(error);\n      });\n    });\n  });\n};\nexport var getPatients = function getPatients() {\n  return new Promise(function (resolve, reject) {\n    db.transaction(function (tx) {\n      tx.executeSql(`SELECT * FROM patients ORDER BY created_at DESC;`, [], function (_, _ref) {\n        var _array = _ref.rows._array;\n        return resolve(_array);\n      }, function (_, error) {\n        return reject(error);\n      });\n    });\n  });\n};\nexport var updatePatientCategory = function updatePatientCategory(id, category) {\n  return new Promise(function (resolve, reject) {\n    db.transaction(function (tx) {\n      tx.executeSql(`UPDATE patients SET triage_category = ? WHERE id = ?;`, [category, id], function (_, result) {\n        return resolve(result);\n      }, function (_, error) {\n        return reject(error);\n      });\n    });\n  });\n};","map":{"version":3,"names":["SQLite","db","openDatabase","initDB","Promise","resolve","reject","transaction","tx","executeSql","_","error","addPatient","patient","name","photo_uri","dob","estimated_age","chief_complaint","triage_category","last_scan_result","result","getPatients","_ref","_array","rows","updatePatientCategory","id","category"],"sources":["/Users/ae/Revive/SoundScopeAI/triage_dashboard/src/services/DatabaseService.js"],"sourcesContent":["import * as SQLite from 'expo-sqlite';\n\nconst db = SQLite.openDatabase('soundscope.db');\n\nexport const initDB = () => {\n  return new Promise((resolve, reject) => {\n    db.transaction(tx => {\n      tx.executeSql(\n        `CREATE TABLE IF NOT EXISTS patients (\n          id INTEGER PRIMARY KEY AUTOINCREMENT,\n          name TEXT NOT NULL,\n          photo_uri TEXT,\n          dob TEXT,\n          estimated_age INTEGER,\n          chief_complaint TEXT,\n          triage_category TEXT DEFAULT 'P3',\n          last_scan_result TEXT,\n          created_at TEXT DEFAULT CURRENT_TIMESTAMP\n        );`,\n        [],\n        () => resolve(),\n        (_, error) => reject(error)\n      );\n    });\n  });\n};\n\nexport const addPatient = (patient) => {\n  return new Promise((resolve, reject) => {\n    const { name, photo_uri, dob, estimated_age, chief_complaint, triage_category, last_scan_result } = patient;\n    db.transaction(tx => {\n      tx.executeSql(\n        `INSERT INTO patients (name, photo_uri, dob, estimated_age, chief_complaint, triage_category, last_scan_result) VALUES (?, ?, ?, ?, ?, ?, ?);`,\n        [name, photo_uri, dob, estimated_age, chief_complaint, triage_category || 'P3', last_scan_result || ''],\n        (_, result) => resolve(result),\n        (_, error) => reject(error)\n      );\n    });\n  });\n};\n\nexport const getPatients = () => {\n  return new Promise((resolve, reject) => {\n    db.transaction(tx => {\n      tx.executeSql(\n        `SELECT * FROM patients ORDER BY created_at DESC;`,\n        [],\n        (_, { rows: { _array } }) => resolve(_array),\n        (_, error) => reject(error)\n      );\n    });\n  });\n};\n\nexport const updatePatientCategory = (id, category) => {\n  return new Promise((resolve, reject) => {\n    db.transaction(tx => {\n      tx.executeSql(\n        `UPDATE patients SET triage_category = ? WHERE id = ?;`,\n        [category, id],\n        (_, result) => resolve(result),\n        (_, error) => reject(error)\n      );\n    });\n  });\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}