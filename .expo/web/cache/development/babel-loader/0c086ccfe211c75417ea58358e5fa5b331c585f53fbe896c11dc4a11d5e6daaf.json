{"ast":null,"code":"import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport React, { useState, useEffect } from 'react';\nimport View from \"react-native-web/dist/exports/View\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport Modal from \"react-native-web/dist/exports/Modal\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport Button from \"react-native-web/dist/exports/Button\";\nimport { useApp } from \"../context/AppContext\";\nimport { requestAudioPermissions, startAudioStream, stopAudioStream } from \"../services/AudioService\";\nimport AudioWaveform from \"./AudioWaveform\";\nimport { jsx as _jsx, jsxs as _jsxs } from \"react/jsx-runtime\";\nexport default function DeviceSetupModal(_ref) {\n  var visible = _ref.visible,\n    onClose = _ref.onClose;\n  var _useApp = useApp(),\n    audioSource = _useApp.audioSource,\n    setAudioSource = _useApp.setAudioSource;\n  var _useState = useState(-160),\n    _useState2 = _slicedToArray(_useState, 2),\n    metering = _useState2[0],\n    setMetering = _useState2[1];\n  var _useState3 = useState(null),\n    _useState4 = _slicedToArray(_useState3, 2),\n    recording = _useState4[0],\n    setRecording = _useState4[1];\n  useEffect(function () {\n    var activeRecording = null;\n    if (visible) {\n      _asyncToGenerator(function* () {\n        var hasPermission = yield requestAudioPermissions();\n        if (hasPermission) {\n          activeRecording = yield startAudioStream(function (level) {\n            setMetering(level);\n          });\n          setRecording(activeRecording);\n        }\n      })();\n    } else {\n      stopAudio();\n    }\n    return function () {\n      stopAudio();\n    };\n  }, [visible]);\n  var stopAudio = function () {\n    var _ref3 = _asyncToGenerator(function* () {\n      if (recording) {\n        yield stopAudioStream(recording);\n        setRecording(null);\n      }\n    });\n    return function stopAudio() {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n  var handleSourceSelect = function handleSourceSelect(source) {\n    setAudioSource(source);\n  };\n  return _jsx(Modal, {\n    visible: visible,\n    animationType: \"slide\",\n    transparent: true,\n    children: _jsx(View, {\n      style: styles.overlay,\n      children: _jsxs(View, {\n        style: styles.modalContent,\n        children: [_jsx(Text, {\n          style: styles.title,\n          children: \"Audio Input Configuration\"\n        }), _jsx(Text, {\n          style: styles.subtitle,\n          children: \"Select Source\"\n        }), _jsxs(View, {\n          style: styles.options,\n          children: [_jsx(TouchableOpacity, {\n            style: [styles.option, audioSource === 'internal' && styles.optionSelected],\n            onPress: function onPress() {\n              return handleSourceSelect('internal');\n            },\n            children: _jsx(Text, {\n              style: [styles.optionText, audioSource === 'internal' && styles.optionTextSelected],\n              children: \"Internal Mic\"\n            })\n          }), _jsx(TouchableOpacity, {\n            style: [styles.option, audioSource === 'external' && styles.optionSelected],\n            onPress: function onPress() {\n              return handleSourceSelect('external');\n            },\n            children: _jsx(Text, {\n              style: [styles.optionText, audioSource === 'external' && styles.optionTextSelected],\n              children: \"Digital Stethoscope (External)\"\n            })\n          })]\n        }), _jsxs(View, {\n          style: styles.waveformContainer,\n          children: [_jsx(Text, {\n            style: styles.waveformLabel,\n            children: \"Signal Check\"\n          }), _jsx(AudioWaveform, {\n            metering: metering\n          }), _jsx(Text, {\n            style: styles.statusText,\n            children: metering > -50 ? \"Signal Detected\" : \"Low / No Signal\"\n          })]\n        }), _jsx(Button, {\n          title: \"Confirm & Close\",\n          onPress: onClose\n        })]\n      })\n    })\n  });\n}\nvar styles = StyleSheet.create({\n  overlay: {\n    flex: 1,\n    backgroundColor: 'rgba(0,0,0,0.5)',\n    justifyContent: 'center',\n    padding: 20\n  },\n  modalContent: {\n    backgroundColor: '#fff',\n    borderRadius: 12,\n    padding: 20\n  },\n  title: {\n    fontSize: 20,\n    fontWeight: 'bold',\n    marginBottom: 8,\n    textAlign: 'center'\n  },\n  subtitle: {\n    fontSize: 16,\n    color: '#666',\n    marginBottom: 16,\n    textAlign: 'center'\n  },\n  options: {\n    flexDirection: 'row',\n    marginBottom: 24,\n    justifyContent: 'center'\n  },\n  option: {\n    paddingVertical: 10,\n    paddingHorizontal: 16,\n    borderWidth: 1,\n    borderColor: '#ccc',\n    marginHorizontal: 4,\n    borderRadius: 8\n  },\n  optionSelected: {\n    backgroundColor: '#E3F2FD',\n    borderColor: '#2196F3'\n  },\n  optionText: {\n    color: '#333'\n  },\n  optionTextSelected: {\n    color: '#2196F3',\n    fontWeight: 'bold'\n  },\n  waveformContainer: {\n    marginBottom: 24,\n    alignItems: 'center'\n  },\n  waveformLabel: {\n    marginBottom: 8,\n    fontSize: 14,\n    color: '#666'\n  },\n  statusText: {\n    marginTop: 8,\n    fontSize: 12,\n    color: '#666'\n  }\n});","map":{"version":3,"names":["React","useState","useEffect","View","Text","Modal","StyleSheet","TouchableOpacity","Button","useApp","requestAudioPermissions","startAudioStream","stopAudioStream","AudioWaveform","jsx","_jsx","jsxs","_jsxs","DeviceSetupModal","_ref","visible","onClose","_useApp","audioSource","setAudioSource","_useState","_useState2","_slicedToArray","metering","setMetering","_useState3","_useState4","recording","setRecording","activeRecording","_asyncToGenerator","hasPermission","level","stopAudio","_ref3","apply","arguments","handleSourceSelect","source","animationType","transparent","children","style","styles","overlay","modalContent","title","subtitle","options","option","optionSelected","onPress","optionText","optionTextSelected","waveformContainer","waveformLabel","statusText","create","flex","backgroundColor","justifyContent","padding","borderRadius","fontSize","fontWeight","marginBottom","textAlign","color","flexDirection","paddingVertical","paddingHorizontal","borderWidth","borderColor","marginHorizontal","alignItems","marginTop"],"sources":["/Users/ae/Revive/SoundScopeAI/triage_dashboard/src/components/DeviceSetupModal.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { View, Text, Modal, StyleSheet, TouchableOpacity, Button } from 'react-native';\nimport { useApp } from '../context/AppContext';\nimport { requestAudioPermissions, startAudioStream, stopAudioStream } from '../services/AudioService';\nimport AudioWaveform from './AudioWaveform';\n\nexport default function DeviceSetupModal({ visible, onClose }) {\n    const { audioSource, setAudioSource } = useApp();\n    const [metering, setMetering] = useState(-160);\n    const [recording, setRecording] = useState(null);\n\n    useEffect(() => {\n        let activeRecording = null;\n        if (visible) {\n            (async () => {\n                const hasPermission = await requestAudioPermissions();\n                if (hasPermission) {\n                    activeRecording = await startAudioStream((level) => {\n                        setMetering(level);\n                    });\n                    setRecording(activeRecording);\n                }\n            })();\n        } else {\n            stopAudio();\n        }\n\n        return () => {\n            stopAudio();\n        };\n    }, [visible]);\n\n    const stopAudio = async () => {\n        if (recording) {\n            await stopAudioStream(recording);\n            setRecording(null);\n        }\n    };\n\n    const handleSourceSelect = (source) => {\n        setAudioSource(source);\n        // In a real app, this would toggle hardware inputs.\n        // Here we just set the state which other components can read.\n    };\n\n    return (\n        <Modal visible={visible} animationType=\"slide\" transparent>\n            <View style={styles.overlay}>\n                <View style={styles.modalContent}>\n                    <Text style={styles.title}>Audio Input Configuration</Text>\n                    <Text style={styles.subtitle}>Select Source</Text>\n\n                    <View style={styles.options}>\n                        <TouchableOpacity\n                            style={[styles.option, audioSource === 'internal' && styles.optionSelected]}\n                            onPress={() => handleSourceSelect('internal')}\n                        >\n                            <Text style={[styles.optionText, audioSource === 'internal' && styles.optionTextSelected]}>\n                                Internal Mic\n                            </Text>\n                        </TouchableOpacity>\n\n                        <TouchableOpacity\n                            style={[styles.option, audioSource === 'external' && styles.optionSelected]}\n                            onPress={() => handleSourceSelect('external')}\n                        >\n                            <Text style={[styles.optionText, audioSource === 'external' && styles.optionTextSelected]}>\n                                Digital Stethoscope (External)\n                            </Text>\n                        </TouchableOpacity>\n                    </View>\n\n                    <View style={styles.waveformContainer}>\n                        <Text style={styles.waveformLabel}>Signal Check</Text>\n                        <AudioWaveform metering={metering} />\n                        <Text style={styles.statusText}>\n                            {metering > -50 ? \"Signal Detected\" : \"Low / No Signal\"}\n                        </Text>\n                    </View>\n\n                    <Button title=\"Confirm & Close\" onPress={onClose} />\n                </View>\n            </View>\n        </Modal>\n    );\n}\n\nconst styles = StyleSheet.create({\n    overlay: {\n        flex: 1,\n        backgroundColor: 'rgba(0,0,0,0.5)',\n        justifyContent: 'center',\n        padding: 20,\n    },\n    modalContent: {\n        backgroundColor: '#fff',\n        borderRadius: 12,\n        padding: 20,\n    },\n    title: {\n        fontSize: 20,\n        fontWeight: 'bold',\n        marginBottom: 8,\n        textAlign: 'center',\n    },\n    subtitle: {\n        fontSize: 16,\n        color: '#666',\n        marginBottom: 16,\n        textAlign: 'center',\n    },\n    options: {\n        flexDirection: 'row',\n        marginBottom: 24,\n        justifyContent: 'center',\n    },\n    option: {\n        paddingVertical: 10,\n        paddingHorizontal: 16,\n        borderWidth: 1,\n        borderColor: '#ccc',\n        marginHorizontal: 4,\n        borderRadius: 8,\n    },\n    optionSelected: {\n        backgroundColor: '#E3F2FD',\n        borderColor: '#2196F3',\n    },\n    optionText: {\n        color: '#333',\n    },\n    optionTextSelected: {\n        color: '#2196F3',\n        fontWeight: 'bold',\n    },\n    waveformContainer: {\n        marginBottom: 24,\n        alignItems: 'center',\n    },\n    waveformLabel: {\n        marginBottom: 8,\n        fontSize: 14,\n        color: '#666',\n    },\n    statusText: {\n        marginTop: 8,\n        fontSize: 12,\n        color: '#666',\n    }\n});\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}